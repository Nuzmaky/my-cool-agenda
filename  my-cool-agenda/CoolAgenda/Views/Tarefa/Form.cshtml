@model CoolAgenda.ViewModels.TarefaVM.TarefaVM
@{
    ViewBag.Title = "Tarefa";
}

<style>
    #barrausuario {display:none;}
</style>
<div class="modal-header">
        @{
            if (Model.Edicao)
            {
                ViewBag.Title = "Editar Tarefa";
            <h2>Edite os dados da Tarefa</h2>
            }
            else
            {
                ViewBag.Title = "Cadastrar Tarefa";
            <h2>Nova Tarefa</h2>
            }
        }
        
    </div>
<div class="modal-body">

    @using (Html.BeginForm("Form", "Tarefa", FormMethod.Post, new{ id = "EventForm", @class = "well" }))
    
    {
         string display = ViewData.ModelState.IsValid ? "none" : "block";
        <div class="errorbox" id="validationSummary" style="display:@display; float: right; width: 45%">
            @Html.ValidationSummary()
        </div>
        
        @Html.HiddenFor(m => m.Edicao)
        @Html.HiddenFor(m => m.IdTarefa)
        @Html.HiddenFor(m=>m.IdUsuario)
        @Html.HiddenFor(m=>m.IdCompromisso)
        @Html.HiddenFor(m=>m.Ativo)

        @Html.LabelFor(m => m.NomeTarefa)
        @Html.TextBoxFor(m => m.NomeTarefa) <br />
        
        @Html.LabelFor(m => m.DescTarefa)
        @Html.TextAreaFor(m => m.DescTarefa) <br />
        
        @Html.LabelFor(m => m.DataInicial)
        @Html.TextBoxFor(m => m.DataInicial,new { @class = "datetimepicker-pt-br"}) <br />
        
        @Html.LabelFor(m => m.DataFinal)
        @Html.TextBoxFor(m => m.DataFinal,new { @class = "datetimepicker-pt-br"}) <br />
    }
    </div>
<div class="modal-footer">
       <button type="button" id="btnPopupCancel" data-dismiss="modal" class="btn">Cancelar</button>
       <input type="submit" id="btnPopupSave" data-dismiss="modal" class="btn btn-primary" value="Salvar" form="EventForm" />
    </div>
<script>
       $(document).ready(function () {
           jQuery(".datetimepicker-pt-br").datetimepicker({
               lang: 'pt',
               format: 'd/m/y H:i',
               step: 30
            });
        });

       $(document).ready(function () {
           $('#btnPopupSave').click(function (e) {
               e.preventDefault();
               $.ajax({
                   type: "POST",
                   url: '@Url.Action("Cadastrar", "Compromisso")',
                data: $('form').serialize(),
                success: function (result) {
                    if (result.redirectTo) {
                        window.location.href = result.redirectTo;
                    } else {
                        $("#popupEventForm").html(result);
                    }
                },
                error: function () {

                }
            });
        });
       });


    $('#btnPopupCancel').click(function () {
        resetValidation();
        ClearPopupFormValues();
        $('#popupEventForm').hide();

    });
    </script>
 
    


